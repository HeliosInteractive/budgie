/*! @helios-interactive/thrush 25-04-2017 */

!function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,a),this.selector=d,this.options=Object.assign(this.constructor.defaultOptions(),e),this.isNew=!0,this.position=Math.floor(65536*(1+Math.random())),this.items=b,this.adjustedItems=[];var f=this;this.items.pop=function(){var a=Array.prototype.pop.apply(f.items,arguments);return f.popItem(),a},this.items.push=function(){var a=Array.prototype.push.apply(f.items,arguments);return f.pushItem(),a},this.items.shift=function(){var a=Array.prototype.shift.apply(f.items,arguments);return f.shiftItem(),a},this.items.unshift=function(){var a=Array.prototype.unshift.apply(f.items,arguments);return f.unshiftItem(),a},this.items.splice=function(){var a=Array.prototype.splice.apply(f.items,arguments);return f.updateAllElements(),a},this.start()}return e(a,[{key:"setupContainer",value:function(){var a=this.constructor.getElement(this.selector);a.classList.add("infinite-flex-container-parent-"+this.position),this.parentContainer=a;var b=document.createElement("div");b.classList.add("infinite-flex-container"),b.classList.add("infinite-container-"+this.position),a.appendChild(b),this.setCSS(b),this.container=b}},{key:"bindScrollListener",value:function(){var a=this,b=this.scrollSizeMeasurement(),c=this.scrollProperty();this.options.inverted&&this.isNew&&(this.parentContainer[c]=b),this.parentContainer.addEventListener("scroll",function(){a.onScroll(c)})}},{key:"createItemList",value:function(){switch(this.options.oddEndingBehavior){case"duplicate":break;case"clip":this.adjustedItems=this.items.slice(0,this.items.length-this.numberLeftWithOddEnding());break;default:this.adjustedItems=this.items}}},{key:"numberLeftWithOddEnding",value:function(){var a="horizontal"===this.options.direction?this.options.numberHigh:this.options.numberWide;return this.items.length%a}},{key:"setCSS",value:function(a){var b=parseInt(window.getComputedStyle(a).width),c=0;document.styleSheets[0].cssRules&&(c=document.styleSheets[0].cssRules.length);var d="horizontal"===this.options.direction?this.options.numberHigh:this.options.numberWide,e=b/this.options.numberWide/b*100,f=100/this.options.numberHigh;document.styleSheets[0].insertRule(".infinite-flex-item-"+this.position+"{width: "+e+"%; height: "+f+"%;}",c),document.styleSheets[0].insertRule(".infinite-flex-item-image-"+this.position+"{background-size: "+this.options.imageFit+";}",c);for(var g=d-1;g>=0;g--)document.styleSheets[0].insertRule(".infinite-flex-item-"+this.position+"--filler-"+g+"{width: "+e*(d-g)/2+"%; height: "+f*(d-g)/2+"%; flex-grow: 1;}",c);var h="horizontal"===this.options.direction?"column":"row";document.styleSheets[0].insertRule(".infinite-container-"+this.position+"{flex-direction: "+h+";}",c),document.styleSheets[0].insertRule(".infinite-flex-container-parent-"+this.position+"{overflow: hidden;}",c),document.styleSheets[0].insertRule(".infinite-flex-container-parent-"+this.position+"::-webkit-scrollbar{display: none;}",c)}},{key:"insertItems",value:function(){var a=this;if(this.adjustedItems.forEach(function(b,c){a.numberLeftWithOddEnding()>0&&a.items.length-a.numberLeftWithOddEnding()===c&&a.container.appendChild(a.newFillerItem()),a.container.appendChild(a.constructor.createElementForItem(b,c,a.position)),a.numberLeftWithOddEnding()>0&&a.items.length===c+1&&a.container.appendChild(a.newFillerItem())}),this.items.length<this.elementsOnScreen()){var b=document.createElement("div");b.classList.add("infinite-flex-item-"+this.position+"--blank"),this.container.appendChild(b)}}},{key:"newFillerItem",value:function(){var a=document.createElement("div");return a.classList.add("infinite-flex-item-"+this.position+"--filler"),a.classList.add("infinite-flex-item-"+this.position+"--filler-"+this.numberLeftWithOddEnding()),a}},{key:"appendExtraItems",value:function(){var a=this,b=this.elementsOnScreen();this.createItemList(),this.adjustedItems.length>b&&[].slice.call(document.getElementsByClassName("infinite-flex-item-"+this.position),0,b).forEach(function(b){var c=b.cloneNode(!0);c.classList.add("infinite-flex-item-"+a.position+"--duplicate"),a.container.appendChild(c)})}},{key:"elementsOnScreen",value:function(){return parseInt(this.options.numberHigh)*parseInt(this.options.numberWide)}},{key:"pushItem",value:function(){this.addLastItem(),this.updateListEnding("add"),this.start()}},{key:"popItem",value:function(){this.removeLastItem(),this.updateListEnding("remove"),this.start()}},{key:"shiftItem",value:function(){this.updateExistingItems(),this.removeLastItem(),this.updateListEnding("remove"),this.start()}},{key:"unshiftItem",value:function(){this.updateExistingItems(),this.addLastItem(),this.updateListEnding("add"),this.start()}},{key:"updateAllElements",value:function(){var a=document.querySelectorAll(".infinite-flex-item-"+this.position+":not(.infinite-flex-item-"+this.position+"--duplicate)").length;if(this.items.length>a){for(var b=a;b<this.items.length;b++)this.addLastItem(b,b-1);this.updateListEnding("add",!0)}else if(this.items.length<a){for(var c=a;c>this.items.length;c--)this.removeLastItem(c-1);this.updateListEnding("remove",!0)}this.updateExistingItems(),this.start()}},{key:"removeLastItem",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,b=document.getElementsByClassName("infinite-"+this.position+"-"+a);b[0].parentNode.removeChild(b[0])}},{key:"addLastItem",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length-1,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.items.length-2,c=document.getElementsByClassName("infinite-"+this.position+"-"+b),d=this.constructor.createElementForItem(this.items[a],a,this.position);c[0].parentNode.insertBefore(d,c[0].nextSibling)}},{key:"updateExistingItems",value:function(){var a=this;this.items.forEach(function(b,c){Array.from(document.getElementsByClassName("infinite-"+a.position+"-"+c)).forEach(function(a){return a.style.backgroundImage="url("+b+")"})})}},{key:"updateListEnding",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=void 0;if("remove"===a)d=1;else{if("add"!==a)throw new Error("Only 'add' and 'remove' are supported arguments");d=-1}if(c&&Array.from(document.getElementsByClassName("infinite-flex-item-"+this.position+"--filler")).forEach(function(a){return a.parentNode.removeChild(a)}),this.numberLeftWithOddEnding()>0)if(0===document.getElementsByClassName("infinite-flex-item-"+this.position+"--filler").length){var e=document.getElementsByClassName("infinite-"+this.position+"-"+(this.items.length-1))[0],f=document.getElementsByClassName("infinite-"+this.position+"-"+(this.items.length-this.numberLeftWithOddEnding()))[0];f.parentNode.insertBefore(this.newFillerItem(),f),e.parentNode.insertBefore(this.newFillerItem(),e.nextSibling)}else Array.from(document.getElementsByClassName("infinite-flex-item-"+this.position+"--filler")).forEach(function(a){a.classList.remove("infinite-flex-item-"+b.position+"--filler-"+(b.numberLeftWithOddEnding()+d)),a.classList.add("infinite-flex-item-"+b.position+"--filler-"+b.numberLeftWithOddEnding())});else Array.from(document.getElementsByClassName("infinite-flex-item-"+this.position+"--filler")).forEach(function(a){return a.parentNode.removeChild(a)});if(this.items.length<=this.elementsOnScreen()&&(Array.from(document.getElementsByClassName("infinite-flex-item-"+this.position+"--duplicate")).forEach(function(a){return a.parentNode.removeChild(a)}),0===document.getElementsByClassName("infinite-flex-item-"+this.position+"--blank").length)){var g=document.createElement("div");g.classList.add("infinite-flex-item-"+this.position+"--blank"),this.container.appendChild(g)}this.items.length>this.elementsOnScreen()&&0===document.getElementsByClassName("infinite-flex-item-"+this.position+"--duplicate").length&&(this.appendExtraItems(),Array.from(document.getElementsByClassName("infinite-flex-item-"+this.position+"--blank")).forEach(function(a){return a.parentNode.removeChild(a)}))}},{key:"elementMeasurement",value:function(a){var b={};return b.height=parseFloat(window.getComputedStyle(document.getElementsByClassName(a)[0]).height),b.width=parseFloat(window.getComputedStyle(document.getElementsByClassName(a)[0]).width),b}},{key:"scrollSizeMeasurement",value:function(){switch(this.options.direction){case"vertical":return this.elementMeasurement("infinite-flex-item-"+this.position).height*Math.ceil(this.adjustedItems.length/this.options.numberWide);case"horizontal":return this.elementMeasurement("infinite-flex-item-"+this.position).width*Math.ceil(this.adjustedItems.length/this.options.numberHigh)}}},{key:"changeInversion",value:function(){this.options.inverted=!this.options.inverted}},{key:"onScroll",value:function(a){var b=this.scrollSizeMeasurement();this.parentContainer[a]>=b?this.parentContainer[a]=0:this.parentContainer[a]<=0&&(this.parentContainer[a]=b)}},{key:"scrollProperty",value:function(){return"vertical"===this.options.direction?"scrollTop":"horizontal"===this.options.direction?"scrollLeft":void 0}},{key:"startAnimation",value:function(){var a=this,b=this.options.fps,c=this.scrollProperty(),d=this.container.parentElement,e=void 0,f=this.elementMeasurement("infinite-container-"+this.position),g="horizontal"===this.options.direction?f.width:f.height,h=g/this.options.secondsOnPage/b;this.stop(),this.items.length>this.elementsOnScreen()?this.interval=setInterval(function(){var b=a.scrollProperty();e=d[b],a.options.inverted?e-=h:e+=h,d[b]=e},1e3/b):d[c]=0}},{key:"start",value:function(){this.isNew&&(this.setupContainer(),this.createItemList(),this.insertItems(),this.appendExtraItems(),this.bindScrollListener()),this.options.autoScroll&&this.startAnimation(),this.isNew=!1}},{key:"stop",value:function(){return!!this.interval&&(window.clearInterval(this.interval),!0)}},{key:"remove",value:function(){this.stop(),this.container.parentElement.classList.remove("infinite-flex-container-parent-"+this.position),this.container.parentElement.removeChild(this.container)}}],[{key:"defaultOptions",value:function(){return{numberHigh:1,numberWide:1,oddEndingBehavior:"default",noScrollIfNoOverflow:!0,direction:"vertical",secondsOnPage:1,stopOnHover:!1,inverted:!1,autoScroll:!0,userNavigation:!1,imageFit:"cover",fps:60}}},{key:"getElement",value:function(a){if("object"===(void 0===a?"undefined":d(a)))return a;switch(a.substring(0,1)){case".":return document.getElementsByClassName(a.substring(1))[0];case"#":return document.getElementById(a.substring(1));default:throw new Error("The selector must be a class or id, prepended by the identifier ('.'/'#')")}}},{key:"createElementForItem",value:function(a,b,c){var d=document.createElement("div");return"string"==typeof a?d.style.backgroundImage="url("+a+")":d.appendChild(a),d.classList.add("infinite-flex-item-"+c),d.classList.add("infinite-flex-item-image-"+c),d.classList.add("infinite-"+c+"-"+b),d}}]),a}();void 0!==b&&(b.InfiniteScroller=f),b.true=a}({},function(){return this}());
//# sourceMappingURL=thrush.es6.map