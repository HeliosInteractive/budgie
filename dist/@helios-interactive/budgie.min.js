/*! @helios-interactive/budgie 15-06-2017 */

!function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=document.createElement("style");f.innerHTML="\n.budgie-container {\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: center; }\n\n.budgie-item :first-child {\n  max-height: 100%;\n  max-width: 100%; }\n\n.budgie-container-parent {\n  overflow: -moz-scrollbars-none; }\n  .budgie-container-parent::-webkit-scrollbar {\n    display: none; }\n",document.head.appendChild(f);var g=["jpg","gif","png","bmp","jpeg"],h=["mp4","ogg","webm"],i=Object.create({setupBudgieContainer:function(a){a.parentContainer.classList.add("budgie-container-parent"),a.parentContainer.classList.add("budgie-container-parent-"+a.budgieId);var b=document.createElement("div");return b.classList.add("budgie-container"),b.classList.add("budgie-container-"+a.budgieId),a.parentContainer.appendChild(b),b},setupBudgieCSS:function(a){var b=parseInt(window.getComputedStyle(a.budgieContainer).width),c=0;document.styleSheets[0].cssRules&&(c=document.styleSheets[0].cssRules.length);var d=a.options.numberHigh>=a.options.numberWide?a.options.numberHigh:a.options.numberWide,e=b/a.options.numberWide/b*100,f=100/a.options.numberHigh;document.styleSheets[0].insertRule(".budgie-item-"+a.budgieId+"{width: "+e+"%; height: "+f+"%;}",c);for(var g=d-1;g>=0;g--)document.styleSheets[0].insertRule(".budgie-item-"+a.budgieId+"--filler-"+g+"\n        {\n          width: "+e*(a.options.numberWide-g)/2+"%; \n          height: "+f*(a.options.numberHigh-g)/2+"%; flex-grow: 1;\n        }",c);var h="horizontal"===a.options.direction?"column":"row";document.styleSheets[0].insertRule(".budgie-container-"+a.budgieId+"{flex-direction: "+h+";}",c),document.styleSheets[0].insertRule(".budgie-container-parent-"+a.budgieId+"\n      {\n        overflow-x: "+("horizontal"===a.options.direction?"scroll":"hidden")+"; \n        overflow-y: "+("vertical"===a.options.direction?"scroll":"hidden")+"\n      }",c)},setupBudgieScrollProperties:function(a){var b=a.scrollProperty(),c=i.measureElementWidthAndHeight(".budgie-item-"+a.budgieId),d=a.isHorizontal()?c.width:c.height;a.parentContainer[b]=d,a.parentContainer.addEventListener("scroll",function(){a.onScroll(b)})},setupBudgieMouseDrag:function(a){var b=a.scrollProperty();a.parentContainer.addEventListener("mousedown",function(){a.mouseDown=!0}),a.parentContainer.addEventListener("mouseup",function(){a.mouseDown=!1}),a.parentContainer.addEventListener("mouseout",function(){a.mouseDown=!1}),a.parentContainer.addEventListener("mousemove",function(c){a.onMouseMove(c,b)})},insertBudgieElements:function(a){if(a.items.forEach(function(b,c){a.hasOddEnding()&&a.items.length-a.numberLeftWithOddEnding()===c&&a.budgieContainer.appendChild(i.createBudgieFillerElement(a)),a.budgieContainer.appendChild(i.createBudgieElement(a,b,c)),a.hasOddEnding()>0&&a.items.length===c+1&&a.budgieContainer.appendChild(i.createBudgieFillerElement(a))}),a.fitsInContainer()){var b=document.createElement("div");b.classList.add("budgie-item-"+a.budgieId+"--blank"),a.budgieContainer.appendChild(b)}},createBudgieFillerElement:function(a){var b=document.createElement("div");return b.classList.add("budgie-item-"+a.budgieId+"--filler"),b.classList.add("budgie-item-"+a.budgieId+"--filler-"+a.numberLeftWithOddEnding()),b},createBudgieElement:function(a,b,c){var d=document.createElement("div");d.classList.add("budgie-item"),d.classList.add("budgie-item-"+a.budgieId),d.classList.add("budgie-"+a.budgieId+"-"+c);var e=i.convertItemToElement(b);return d.innerHTML=e.outerHTML,d},convertItemToElement:function(a){if("object"===(void 0===a?"undefined":e(a)))return a;if("string"!=typeof a)throw new Error("Only DOM Elements and strings are accepted as budgie items");var b=a.match(/\.{1}\w*$/);b&&(b=b[0].substr(1));var c=void 0;if(g.includes(b)?(c=document.createElement("img"),c.src=a):h.includes(b)&&(c=document.createElement("video"),c.src=a),!c)throw new Error("Extension of: "+b+" is not supported.");return c},measureElementWidthAndHeight:function(a){var b={},c=window.getComputedStyle(document.querySelector(a));return b.height=parseFloat(c.height),b.width=parseFloat(c.width),b}}),j=function(){function a(b,d){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,a),this.parentContainer=document.querySelector(d),this.options=Object.assign(this.constructor.defaultOptions(),e),this.budgieId=Math.floor(65536*(1+Math.random())),this.items=b,this.previousItems=[],this.mouseDown=!1;var f=this;this.items.pop=function(){var a=Array.prototype.pop.apply(f.items,arguments);return f.popItem(),a},this.items.push=function(){var a=Array.prototype.push.apply(f.items,arguments);return f.pushItem(),a},this.items.shift=function(){var a=Array.prototype.shift.apply(f.items,arguments);return f.shiftItem(),a},this.items.unshift=function(){var a=Array.prototype.unshift.apply(f.items,arguments);return f.unshiftItem(),a},this.items.splice=function(){var a=Array.prototype.splice.apply(f.items,arguments);return f.updateAllElements(),a},this.budgieSetup(),this.options.autoStart&&this.budgieAnimate()}return d(a,[{key:"isVertical",value:function(){return"vertical"===this.options.direction}},{key:"isHorizontal",value:function(){return"horizontal"===this.options.direction}},{key:"hasOddEnding",value:function(){return this.numberLeftWithOddEnding()>0}},{key:"elementsOnScreen",value:function(){return parseInt(this.options.numberHigh)*parseInt(this.options.numberWide)}},{key:"fitsInContainer",value:function(){return this.items.length<=this.elementsOnScreen()}},{key:"numberLeftWithOddEnding",value:function(){var a=this.isHorizontal()?this.options.numberHigh:this.options.numberWide;return this.items.length%a}},{key:"clearMeasurements",value:function(){this.budgieElementMeasurement=void 0,this.scrollContainerSize=void 0}},{key:"scrollProperty",value:function(){return this.isVertical()?"scrollTop":this.isHorizontal()?"scrollLeft":void 0}},{key:"elementMeasurement",value:function(a){var b={};return b.height=parseFloat(window.getComputedStyle(document.getElementsByClassName(a)[0]).height),b.width=parseFloat(window.getComputedStyle(document.getElementsByClassName(a)[0]).width),b}},{key:"scrollSizeMeasurement",value:function(){switch(this.options.direction){case"vertical":return i.measureElementWidthAndHeight(".budgie-item-"+this.budgieId).height*Math.ceil(this.items.length/this.options.numberWide);case"horizontal":return i.measureElementWidthAndHeight(".budgie-item-"+this.budgieId).width*Math.ceil(this.items.length/this.options.numberHigh)}}},{key:"setItems",value:function(a){var b=this;this.numberLeftWithOddEnding();this.previousItems=this.items.slice(),this.items=a.slice();var c=function(a,b){return a.map(function(a,c){if(!b.some(function(b){return b===a}))return c}).filter(function(a){return a||0===a})}(this.previousItems,this.items),d=function(a,b){return b.map(function(b,c){if(!a.some(function(a){return a===b}))return c}).filter(function(a){return a||0===a})}(this.previousItems,this.items);c.length>0&&c.forEach(function(a){b.removeLastItem(a)}),d.length>0&&d.forEach(function(a){b.addItemAtIndex(a)});var e=Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+":not(.budgie-item-"+this.budgieId+"--duplicate)"));e.forEach(function(a,c){var d=Array.from(a.classList).filter(function(a){return a.match(new RegExp("budgie-"+b.budgieId+"-\\d"))});a.classList.remove(d),a.classList.add("budgie-"+b.budgieId+"-"+c)}),Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+".budgie-item-"+this.budgieId+"--duplicate")).forEach(function(a){a.parentNode.removeChild(a)}),Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+"--filler")).forEach(function(a){a.parentNode.removeChild(a)}),this.prependStartingItems(),this.appendEndingItems(),this.numberLeftWithOddEnding()>0&&(e[e.length-this.numberLeftWithOddEnding()].insertAdjacentElement("beforebegin",i.createBudgieFillerElement(this)),e[e.length-1].insertAdjacentElement("afterend",i.createBudgieFillerElement(this))),this.clearMeasurements(),this.budgieAnimate()}},{key:"pushItem",value:function(){this.addLastItem(),this.updateBeginningAndEndingItems("add"),this.clearMeasurements(),this.budgieAnimate()}},{key:"popItem",value:function(){this.removeLastItem(),this.updateBeginningAndEndingItems("remove"),this.clearMeasurements(),this.budgieAnimate()}},{key:"shiftItem",value:function(){this.updateExistingItems(),this.removeLastItem(),this.updateBeginningAndEndingItems("remove"),this.clearMeasurements(),this.budgieAnimate()}},{key:"unshiftItem",value:function(){this.updateExistingItems(),this.addLastItem(),this.updateBeginningAndEndingItems("add"),this.clearMeasurements(),this.budgieAnimate()}},{key:"updateAllElements",value:function(){var a=document.querySelectorAll(".budgie-item-"+this.budgieId+":not(.budgie-item-"+this.budgieId+"--duplicate)").length;if(this.items.length>a){for(var b=a;b<this.items.length;b++)this.addLastItem(b,b-1);this.updateBeginningAndEndingItems("add")}else if(this.items.length<a){for(var c=a;c>this.items.length;c--)this.removeLastItem(c-1);this.updateBeginningAndEndingItems("remove")}this.updateExistingItems(),this.clearMeasurements(),this.budgieAnimate()}},{key:"prependStartingItems",value:function(){var a=this,b=(this.elementsOnScreen(),Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+":not(.budgie-item-"+this.budgieId+"--duplicate)")));if(!this.fitsInContainer())if(this.hasOddEnding())this.budgieContainer.insertAdjacentElement("afterbegin",i.createBudgieFillerElement(this)),b.slice(b.length-this.numberLeftWithOddEnding(),b.length).reverse().forEach(function(b){var c=b.cloneNode(!0);c.classList.add("budgie-item-"+a.budgieId+"--duplicate"),a.budgieContainer.insertAdjacentElement("afterbegin",c)}),this.budgieContainer.insertAdjacentElement("afterbegin",i.createBudgieFillerElement(this));else{var c=this.isHorizontal()?this.options.numberHigh:this.options.numberWide;b.slice(b.length-c,b.length).reverse().forEach(function(b){var c=b.cloneNode(!0);c.classList.add("budgie-item-"+a.budgieId+"--duplicate"),a.budgieContainer.insertAdjacentElement("afterbegin",c)})}}},{key:"appendEndingItems",value:function(){var a=this,b=this.elementsOnScreen(),c=Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+":not(.budgie-item-"+this.budgieId+"--duplicate)"));this.fitsInContainer()||c.slice(0,b).forEach(function(b){var c=b.cloneNode(!0);c.classList.add("budgie-item-"+a.budgieId+"--duplicate"),c.classList.add("budgie-item-"+a.budgieId+"--duplicate-ending"),a.budgieContainer.insertAdjacentElement("beforeend",c)})}},{key:"addItemAtIndex",value:function(a){var b=Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+":not(.budgie-item-"+this.budgieId+"--duplicate)")),c=i.createBudgieElement(this,this.items[a],a);a>0?b[a-1].insertAdjacentElement("afterend",c):b[a].insertAdjacentElement("beforebegin",c)}},{key:"removeLastItem",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,b=document.getElementsByClassName("budgie-"+this.budgieId+"-"+a);Array.from(b).forEach(function(a){a.parentNode.removeChild(a)})}},{key:"addLastItem",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length-1,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.items.length-2,c=document.getElementsByClassName("budgie-"+this.budgieId+"-"+b);!c.length>0&&(c=document.getElementsByClassName("budgie-item-"+this.budgieId+"--blank"));var d=i.createBudgieElement(this,this.items[a],a),e=0;c.length>1&&(e=1),c[e].parentNode.insertBefore(d,c[e].nextSibling)}},{key:"updateExistingItems",value:function(){var a=this;this.items.forEach(function(b,c){Array.from(document.getElementsByClassName("budgie-"+a.budgieId+"-"+c)).forEach(function(d){var e=i.createBudgieElement(a,b,c);d.innerHTML!==e.innerHTML&&(d.innerHTML=e.innerHTML)})})}},{key:"updateBeginningAndEndingItems",value:function(a){this.updateListStart(),this.updateListEnding(a)}},{key:"updateListStart",value:function(){var a=this,b=void 0;b=this.hasOddEnding()?this.numberLeftWithOddEnding():this.isHorizontal()?this.options.numberHigh:this.options.numberWide;var c=Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+":not(.budgie-item-"+this.budgieId+"--duplicate)")),d=Array.from(document.querySelectorAll(".budgie-item-"+this.budgieId+".budgie-item-"+this.budgieId+"--duplicate")),e=d.slice(0,d.length-this.elementsOnScreen()),f=c.slice(c.length-b,c.length),g=c[0];if(e.length>f.length)for(var h=e.length-f.length,i=0;i<h;i+=1)e[i].parentNode.removeChild(e[i]),e.shift();this.fitsInContainer()||f.forEach(function(b,c){var d=b.cloneNode(!0);d.classList.add("budgie-item-"+a.budgieId+"--duplicate"),e[c]?e[c].outerHTML=d.outerHTML:g.parentNode.insertBefore(d,g)})}},{key:"updateListEnding",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=void 0;if("remove"===a)d=1;else{if("add"!==a)throw new Error("Only 'add' and 'remove' are supported arguments");d=-1}if(c&&Array.from(document.getElementsByClassName("budgie-item-"+this.budgieId+"--filler")).forEach(function(a){return a.parentNode.removeChild(a)}),this.hasOddEnding())if(0===document.getElementsByClassName("budgie-item-"+this.budgieId+"--filler").length){var e=Array.from(document.getElementsByClassName("budgie-"+this.budgieId+"-"+(this.items.length-1))),f=Array.from(document.getElementsByClassName("budgie-"+this.budgieId+"-"+(this.items.length-this.numberLeftWithOddEnding())));e.forEach(function(a){a.parentNode.insertBefore(i.createBudgieFillerElement(b),a.nextSibling)}),f.forEach(function(a){a.parentNode.insertBefore(i.createBudgieFillerElement(b),a)})}else Array.from(document.getElementsByClassName("budgie-item-"+this.budgieId+"--filler")).forEach(function(a){a.classList.remove("budgie-item-"+b.budgieId+"--filler-"+(b.numberLeftWithOddEnding()+d)),a.classList.add("budgie-item-"+b.budgieId+"--filler-"+b.numberLeftWithOddEnding())});else Array.from(document.getElementsByClassName("budgie-item-"+this.budgieId+"--filler")).forEach(function(a){return a.parentNode.removeChild(a)});if(this.fitsInContainer()&&(Array.from(document.getElementsByClassName("budgie-item-"+this.budgieId+"--duplicate")).forEach(function(a){return a.parentNode.removeChild(a)}),0===document.getElementsByClassName("budgie-item-"+this.budgieId+"--blank").length)){var g=document.createElement("div");g.classList.add("budgie-item-"+this.budgieId+"--blank"),this.budgieContainer.appendChild(g)}this.fitsInContainer()||0!==document.getElementsByClassName("budgie-item-"+this.budgieId+"--duplicate-ending").length||(this.appendEndingItems(),Array.from(document.getElementsByClassName("budgie-item-"+this.budgieId+"--blank")).forEach(function(a){return a.parentNode.removeChild(a)}))}},{key:"onScroll",value:function(a){if(this.scrollContainerSize||(this.scrollContainerSize=this.scrollSizeMeasurement()),!this.budgieElementMeasurement){var b=i.measureElementWidthAndHeight(".budgie-item-"+this.budgieId);this.budgieElementMeasurement=Math.floor(this.isHorizontal()?b.width:b.height)}this.parentContainer[a]>=this.scrollContainerSize+this.budgieElementMeasurement?this.parentContainer[a]=this.budgieElementMeasurement:this.parentContainer[a]<=0&&(this.parentContainer[a]=this.scrollContainerSize)}},{key:"onMouseMove",value:function(a,b){this.mouseDown&&(this.parentContainer[b]-=this.isHorizontal()?a.movementX:a.movementY,console.log("mouse moved",a))}},{key:"budgieSetup",value:function(){this.budgieContainer=i.setupBudgieContainer(this),i.setupBudgieCSS(this),i.insertBudgieElements(this),i.setupBudgieMouseDrag(this),this.options.infiniteScroll&&(this.appendEndingItems(),this.prependStartingItems(),i.setupBudgieScrollProperties(this))}},{key:"budgieAnimate",value:function(){var a=this;if(this.options.autoScroll){var b=this.options.fps,c=this.scrollProperty(),d=void 0,e=i.measureElementWidthAndHeight(".budgie-container-"+this.budgieId),f=this.isHorizontal()?e.width:e.height,g=Math.ceil(f/this.options.secondsOnPage/b);this.stopAnimate(),this.fitsInContainer()?this.budgieContainer.parentElement[c]=0:this.interval=setInterval(function(){d=a.budgieContainer.parentElement[c],a.options.inverted?d+=g:d-=g,a.budgieContainer.parentElement[c]=d},1e3/b)}}},{key:"changeInversion",value:function(){this.options.inverted=!this.options.inverted}},{key:"stopAnimate",value:function(){return!!this.interval&&(window.clearInterval(this.interval),!0)}},{key:"removeBudgie",value:function(){this.stopAnimate(),this.budgieContainer.parentElement.classList.remove("budgie-container-parent-"+this.budgieId),this.budgieContainer.parentElement.removeChild(this.budgieContainer)}}],[{key:"defaultOptions",value:function(){return{numberHigh:1,numberWide:1,direction:"vertical",secondsOnPage:1,inverted:!1,autoScroll:!0,fps:60,infiniteScroll:!0,autoStart:!0}}}]),a}();void 0!==b&&(b.Budgie=j),b.true=a}({},function(){return this}());
//# sourceMappingURL=budgie.es6.map